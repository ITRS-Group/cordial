<html>
<head>
  <style>
    .CRITICAL {
      background-color: crimson;
      color: white;
    }

    .WARNING {
      background-color: gold;
      color: black;
    }

    .OK {
      background-color: limegreen;
      color: white;
    }

    .UNDEFINED {
      background-color: lightgrey;
      color: black;
    }

    table, th, td {
      table-layout: fixed;
      font-family: Lucida Console, monospace;
      border: 1px solid black;
      border-collapse: collapse;
      padding: 5px;
      text-align: left;
      vertical-align: top;
    }

    td {
      word-wrap: break-word;
    }

    .envname {
      width: 25%;
    }

    dt {
      font-weight: bold;
    }

    .dataview {
      /* border: 1px solid black; */
      padding: 5px;
    }

    .headlines {
      border: 1px solid white;
    }

    .rows {
      font-size: 0.8em;
    }

    .target {
      border: 3px solid blue;
    }
  </style>
</head>
<body>
  <a href="https://www.itrsgroup.com/products/geneos"><img src="cid:logo.png"/></a>

  <h1>ITRS Geneos DV2EMAIL Default Template</h1>

  <p>This content has been generated by the default template built
  into the dv2email program from the ITRS <a
  href="https://github.com/ITRS-Group/cordial">cordial</a> tool set.
  It is normally only seen when testing. If you did not expect to
  receive this please contact the sender and let them know.</p>

  <h2>Dataviews</h2>

  <p>These Dataviews matched the input <b>_VARIABLEPATH</b>:
  <code>{{.Env._VARIABLEPATH}}</code></p>

  <p></p>

  {{range $index, $dataview := .Dataviews}}

  <table class="dataview">
    <tbody>
      <tr><th>Dataview</th><td>{{.Name}}</td></tr>
      <tr><th>XPath</th><td>{{.XPath}}</td></tr>
      <tr><th>Last Sample</th><td>{{.SampleTime}}</td></tr>
      <tr>
        <th>Headlines</th>
        <td>
          <table class="headlines">
            <tbody>
              {{range $headline, $values := .Headlines}}<tr>
                <th class="headlines">{{$headline}}</th>
                <td class="headlines {{.Severity}} {{if and (eq $.Env._HEADLINE $headline)}} target{{end}}">{{$values.Value}}</td>
              </tr>
              {{end}}
            </tbody>
          </table>
        </td>
      </tr>
      <tr>
        <th>Rows</th>
        <td>
          <table class="rows">
            <thead>
              {{range .Columns}}<th>{{.}}</th>{{end}}
            </thead>
            <tbody>
              {{range $row := $.Rows}}
              <tr>
                <th>{{$row}}</th>
                {{range $i, $column := $dataview.Columns}}
                    {{if ne $i 0}}
                      {{with (index $dataview.Table $row $column)}}
                        <td class="cells {{.Severity}}{{if and (eq $.Env._ROWNAME $row) (eq $.Env._COLUMN $column)}} target{{end}}">{{.Value}}</td>
                      {{end}}
                    {{end}}
                {{end}}
              </tr>
              {{end}}
            </tbody>
          </table>
          {{end}}
        </td>
      </tr>
    </tbody>
  </table>

  <h2>Environment Variables</h2>
  <table style="width: 100%;">
    <thead>
      <th class="envname">Name</th>
      <th>Value</th>
    </thead>
    <tbody>
      {{range $key, $value := .Env}}<tr>
        <th class="envname">{{$key}}</th>
        <td style="word-wrap: break-word;">{{$value}}</td>
      </tr>{{end}}
    </tbody>
  </table>
</body>
</html>
